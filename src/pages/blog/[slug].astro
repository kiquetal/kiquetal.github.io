---
import Layout from '../../layouts/Layout.astro';

export function getStaticPaths() {
  return [
    {params: {slug: 'cloud-native-architecture'}},
    {params: {slug: 'kubernetes-security-best-practices'}},
    {params: {slug: 'serverless-data-pipeline'}},
    {params: {slug: 'infrastructure-as-code-terraform'}},
    {params: {slug: 'devsecops-dashboard-integration'}},
  ];
}

const { slug } = Astro.params;

// In a real app, you might fetch this from a CMS or Markdown files
const posts = {
  'cloud-native-architecture': {
    title: {
      en: 'Building Cloud Native Architectures',
      es: 'Construyendo Arquitecturas Nativas en la Nube'
    },
    liveUrl: 'https://shop-microservices.kiquetal.dev',
    content: {
      en: `
        <p>Cloud native architecture is more than just running applications in the cloud. It's about how applications are created and deployed.</p>
        <h3>Key Principles</h3>
        <ul>
          <li>Microservices</li>
          <li>Containers</li>
          <li>DevOps Automation</li>
        </ul>
      `,
      es: `
        <p>La arquitectura nativa en la nube es más que simplemente ejecutar aplicaciones en la nube. Se trata de cómo se crean y despliegan las aplicaciones.</p>
        <h3>Principios Clave</h3>
        <ul>
          <li>Microservicios</li>
          <li>Contenedores</li>
          <li>Automatización DevOps</li>
        </ul>
      `
    }
  },
  'kubernetes-security-best-practices': {
    title: {
      en: 'Kubernetes Security Best Practices',
      es: 'Mejores Prácticas de Seguridad en Kubernetes'
    },
    liveUrl: null,
    content: {
      en: `
        <p>Security in Kubernetes is a vast topic. Here are some essential practices to get started.</p>
        <h3>Essentials</h3>
        <ul>
          <li>RBAC Configuration</li>
          <li>Network Policies</li>
          <li>Pod Security Standards</li>
        </ul>
      `,
      es: `
        <p>La seguridad en Kubernetes es un tema vasto. Aquí hay algunas prácticas esenciales para comenzar.</p>
        <h3>Esenciales</h3>
        <ul>
          <li>Configuración RBAC</li>
          <li>Políticas de Red</li>
          <li>Estándares de Seguridad de Pods</li>
        </ul>
      `
    }
  },
  'serverless-data-pipeline': {
    title: {
      en: 'Building a Serverless Data Pipeline',
      es: 'Construyendo un Pipeline de Datos Serverless'
    },
    liveUrl: 'https://data-pipeline.kiquetal.dev',
    content: {
      en: `
        <p>This post explores how to build a scalable data pipeline using AWS Lambda, Kinesis, and DynamoDB.</p>
        <p><em>Content coming soon...</em></p>
      `,
      es: `
        <p>Este artículo explora cómo construir un pipeline de datos escalable usando AWS Lambda, Kinesis y DynamoDB.</p>
        <p><em>Contenido próximamente...</em></p>
      `
    }
  },
  'infrastructure-as-code-terraform': {
    title: {
      en: 'Infrastructure as Code with Terraform',
      es: 'Infraestructura como Código con Terraform'
    },
    liveUrl: 'https://github.com/kiquetal/terraform-aws-vpc',
    content: {
      en: `
        <p>Learn how to manage your cloud infrastructure efficiently using Terraform modules.</p>
        <p><em>Content coming soon...</em></p>
      `,
      es: `
        <p>Aprende a gestionar tu infraestructura en la nube de manera eficiente usando módulos de Terraform.</p>
        <p><em>Contenido próximamente...</em></p>
      `
    }
  },
  'devsecops-dashboard-integration': {
    title: {
      en: 'Integrating Security into DevOps Dashboards',
      es: 'Integrando Seguridad en Dashboards DevOps'
    },
    liveUrl: 'https://security-dashboard.kiquetal.dev',
    content: {
      en: `
        <p>A guide to visualizing security metrics from SonarQube and Trivy in a unified dashboard.</p>
        <p><em>Content coming soon...</em></p>
      `,
      es: `
        <p>Una guía para visualizar métricas de seguridad de SonarQube y Trivy en un panel unificado.</p>
        <p><em>Contenido próximamente...</em></p>
      `
    }
  }
};

const post = posts[slug];
---

<Layout title={post.title.en}>
	<main>
		<div class="header-row">
			<a href="/blog" class="back-link">← <span class="lang-en">Back</span><span class="lang-es hidden">Volver</span></a>
			<div class="lang-switch">
				<button id="lang-en" class="active">EN</button>
				<span class="separator">/</span>
				<button id="lang-es">ES</button>
			</div>
		</div>

		<article>
			<h1 class="lang-en">{post.title.en}</h1>
			<h1 class="lang-es hidden">{post.title.es}</h1>

			{post.liveUrl && (
				<div class="live-demo-banner">
					<span class="lang-en">Check out the live demo:</span>
					<span class="lang-es hidden">Ver la demo en vivo:</span>
					<a href={post.liveUrl} target="_blank" class="demo-link">{post.liveUrl} ↗</a>
				</div>
			)}
			
			<div class="content lang-en" set:html={post.content.en} />
			<div class="content lang-es hidden" set:html={post.content.es} />
		</article>
	</main>
</Layout>

<script>
	const btnEn = document.getElementById('lang-en');
	const btnEs = document.getElementById('lang-es');
	const enElements = document.querySelectorAll('.lang-en');
	const esElements = document.querySelectorAll('.lang-es');

	function setLanguage(lang) {
		if (lang === 'en') {
			btnEn.classList.add('active');
			btnEs.classList.remove('active');
			enElements.forEach(el => el.classList.remove('hidden'));
			esElements.forEach(el => el.classList.add('hidden'));
		} else {
			btnEs.classList.add('active');
			btnEn.classList.remove('active');
			esElements.forEach(el => el.classList.remove('hidden'));
			enElements.forEach(el => el.classList.add('hidden'));
		}
		localStorage.setItem('preferred-lang', lang);
	}

	btnEn.addEventListener('click', () => setLanguage('en'));
	btnEs.addEventListener('click', () => setLanguage('es'));

	// Check for saved preference
	const savedLang = localStorage.getItem('preferred-lang');
	if (savedLang) {
		setLanguage(savedLang);
	}
</script>

<style>
	main {
		margin: auto;
		padding: 4rem 2rem;
		width: 100%;
		max-width: 800px;
		color: #e2e8f0;
	}

	.header-row {
		display: flex;
		justify-content: space-between;
		align-items: center;
		margin-bottom: 3rem;
	}

	.back-link {
		color: #94a3b8;
		text-decoration: none;
		font-weight: 600;
		transition: color 0.2s;
	}

	.back-link:hover {
		color: white;
	}

	.lang-switch {
		display: flex;
		align-items: center;
		gap: 0.5rem;
		font-weight: 600;
	}

	.lang-switch button {
		background: none;
		border: none;
		color: #64748b;
		cursor: pointer;
		font-size: 1rem;
		padding: 0.25rem;
		transition: color 0.2s;
	}

	.lang-switch button:hover {
		color: #94a3b8;
	}

	.lang-switch button.active {
		color: rgb(var(--accent));
	}

	.separator {
		color: #475569;
	}

	h1 {
		font-size: 2.5rem;
		font-weight: 800;
		margin-bottom: 2rem;
		line-height: 1.2;
	}

	.live-demo-banner {
		background: rgba(56, 189, 248, 0.1);
		border: 1px solid rgba(56, 189, 248, 0.2);
		padding: 1rem;
		border-radius: 8px;
		margin-bottom: 2rem;
		display: flex;
		align-items: center;
		gap: 0.5rem;
		flex-wrap: wrap;
	}

	.demo-link {
		color: rgb(var(--accent));
		font-weight: 600;
		text-decoration: none;
	}

	.demo-link:hover {
		text-decoration: underline;
	}

	.content :global(h3) {
		color: #f8fafc;
		font-size: 1.5rem;
		margin-top: 2rem;
		margin-bottom: 1rem;
	}

	.content :global(p) {
		color: #cbd5e1;
		line-height: 1.8;
		margin-bottom: 1.5rem;
		font-size: 1.1rem;
	}

	.content :global(ul) {
		color: #cbd5e1;
		line-height: 1.8;
		margin-bottom: 1.5rem;
		padding-left: 1.5rem;
	}

	.content :global(li) {
		margin-bottom: 0.5rem;
	}

	.hidden {
		display: none;
	}
</style>
